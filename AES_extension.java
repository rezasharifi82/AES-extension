package com.maresha.aes;
// In The Name Of God 
// The most merciful




//  Info:
//      Developer     :     (Mohammadreza & Alireza) Sharifi
//      License       :     MIT License
//      Spcial Thanks :     GFG website and Google :)
//      *
//      *
//      *
//      *
//      *
//      *
//       .........   Hope you Enjoy :)   .........






import android.app.Activity;
import android.content.Context;
import android.util.Log;
import com.google.appinventor.components.annotations.*;
import com.google.appinventor.components.runtime.*;
import com.google.appinventor.components.common.ComponentCategory;
import java.io.UnsupportedEncodingException;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.Arrays;

import java.util.Base64;
import java.nio.charset.StandardCharsets;
import java.security.spec.KeySpec;
import java.util.Base64;
import javax.crypto.Cipher;
import javax.crypto.SecretKey;
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.PBEKeySpec;
import javax.crypto.spec.SecretKeySpec;



@DesignerComponent(
        version = 1,
        description = "To Encrypt strings with AES",
        category = ComponentCategory.EXTENSION,
        nonVisible = true,
        iconName = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoOTcuNjQ3MDU5JSw4OS4wMTk2MDglLDY4LjIzNTI5NCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSAxMC42MzI4MTIgMTMuMjEwOTM4IEMgMTIuNjI4OTA2IDExLjQ3MjY1NiAxMy44NTU0NjkgOS4wMTk1MzEgMTQuMDQ2ODc1IDYuMzgyODEyIEwgMTQuMjE4NzUgMy40OTYwOTQgQyAxNC4yMzQzNzUgMy4yMjI2NTYgMTQuMDI3MzQ0IDIuOTg0Mzc1IDEzLjc1MzkwNiAyLjk2ODc1IEwgMTIuODQ3NjU2IDIuOTA2MjUgQyAxMS4zMjAzMTIgMi44MDQ2ODggOS44NTkzNzUgMi4yMzgyODEgOC42NjQwNjIgMS4yODEyNSBMIDguMzEyNSAxIEMgOC4xMjg5MDYgMC44NTU0NjkgNy44NzEwOTQgMC44NTU0NjkgNy42ODc1IDEgTCA3LjMzOTg0NCAxLjI4MTI1IEMgNi4xNDA2MjUgMi4yMzgyODEgNC42Nzk2ODggMi44MDQ2ODggMy4xNTIzNDQgMi45MDYyNSBMIDIuMjQ2MDk0IDIuOTY4NzUgQyAxLjk3MjY1NiAyLjk4NDM3NSAxLjc2NTYyNSAzLjIyMjY1NiAxLjc4MTI1IDMuNDk2MDk0IEwgMS45NTMxMjUgNi4zODI4MTIgQyAyLjE0NDUzMSA5LjAxOTUzMSAzLjM3MTA5NCAxMS40NzI2NTYgNS4zNjcxODggMTMuMjEwOTM4IEwgNy42NzE4NzUgMTUuMjE0ODQ0IEMgNy44NTkzNzUgMTUuMzc4OTA2IDguMTQwNjI1IDE1LjM3ODkwNiA4LjMyODEyNSAxNS4yMTQ4NDQgWiBNIDEwLjYzMjgxMiAxMy4yMTA5MzggIi8+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoOTYuNDcwNTg4JSw4Mi43NDUwOTglLDU5LjIxNTY4NiUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSAxNC4yMTg3NSAzLjQ5NjA5NCBMIDE0LjA0Njg3NSA2LjM4MjgxMiBDIDEzLjg1OTM3NSA5LjAxOTUzMSAxMi42Mjg5MDYgMTEuNDc2NTYyIDEwLjYzNjcxOSAxMy4yMTA5MzggTCA4LjMyODEyNSAxNS4yMTQ4NDQgQyA4LjIzNDM3NSAxNS4yOTY4NzUgOC4xMTcxODggMTUuMzM1OTM4IDggMTUuMzM1OTM4IEwgOCAwLjg5MDYyNSBDIDguMTA5Mzc1IDAuODkwNjI1IDguMjE4NzUgMC45MjU3ODEgOC4zMTI1IDEgTCA4LjY2NDA2MiAxLjI4MTI1IEMgOS44NTkzNzUgMi4yMzgyODEgMTEuMzIwMzEyIDIuODA0Njg4IDEyLjg0NzY1NiAyLjkwNjI1IEwgMTMuNzUzOTA2IDIuOTY4NzUgQyAxNC4wMjczNDQgMi45ODQzNzUgMTQuMjM0Mzc1IDMuMjIyNjU2IDE0LjIxODc1IDMuNDk2MDk0IFogTSAxNC4yMTg3NSAzLjQ5NjA5NCAiLz4KPHBhdGggc3R5bGU9IiBzdHJva2U6bm9uZTtmaWxsLXJ1bGU6bm9uemVybztmaWxsOnJnYig1NS4yOTQxMTglLDQyLjM1Mjk0MSUsNjIuMzUyOTQxJSk7ZmlsbC1vcGFjaXR5OjE7IiBkPSJNIDUuNSAxMC44NTkzNzUgQyA1LjM2MzI4MSAxMC44NTkzNzUgNS4yNSAxMC45NzI2NTYgNS4yNSAxMS4xMDkzNzUgTCA1LjI1IDExLjYwOTM3NSBDIDUuMjUgMTEuNzQ2MDk0IDUuMzYzMjgxIDExLjg1OTM3NSA1LjUgMTEuODU5Mzc1IEMgNS42MzY3MTkgMTEuODU5Mzc1IDUuNzUgMTEuNzQ2MDk0IDUuNzUgMTEuNjA5Mzc1IEwgNS43NSAxMS4xMDkzNzUgQyA1Ljc1IDEwLjk3MjY1NiA1LjYzNjcxOSAxMC44NTkzNzUgNS41IDEwLjg1OTM3NSBaIE0gNS41IDEwLjg1OTM3NSAiLz4KPHBhdGggc3R5bGU9IiBzdHJva2U6bm9uZTtmaWxsLXJ1bGU6bm9uemVybztmaWxsOnJnYig1NS4yOTQxMTglLDQyLjM1Mjk0MSUsNjIuMzUyOTQxJSk7ZmlsbC1vcGFjaXR5OjE7IiBkPSJNIDYuNzUgMTAuODU5Mzc1IEMgNi42MTMyODEgMTAuODU5Mzc1IDYuNSAxMC45NzI2NTYgNi41IDExLjEwOTM3NSBMIDYuNSAxMS42MDkzNzUgQyA2LjUgMTEuNzQ2MDk0IDYuNjEzMjgxIDExLjg1OTM3NSA2Ljc1IDExLjg1OTM3NSBDIDYuODg2NzE5IDExLjg1OTM3NSA3IDExLjc0NjA5NCA3IDExLjYwOTM3NSBMIDcgMTEuMTA5Mzc1IEMgNyAxMC45NzI2NTYgNi44ODY3MTkgMTAuODU5Mzc1IDYuNzUgMTAuODU5Mzc1IFogTSA2Ljc1IDEwLjg1OTM3NSAiLz4KPHBhdGggc3R5bGU9IiBzdHJva2U6bm9uZTtmaWxsLXJ1bGU6bm9uemVybztmaWxsOnJnYig1NS4yOTQxMTglLDQyLjM1Mjk0MSUsNjIuMzUyOTQxJSk7ZmlsbC1vcGFjaXR5OjE7IiBkPSJNIDggMTAuODU5Mzc1IEMgNy44NjMyODEgMTAuODU5Mzc1IDcuNzUgMTAuOTcyNjU2IDcuNzUgMTEuMTA5Mzc1IEwgNy43NSAxMS42MDkzNzUgQyA3Ljc1IDExLjc0NjA5NCA3Ljg2MzI4MSAxMS44NTkzNzUgOCAxMS44NTkzNzUgQyA4LjEzNjcxOSAxMS44NTkzNzUgOC4yNSAxMS43NDYwOTQgOC4yNSAxMS42MDkzNzUgTCA4LjI1IDExLjEwOTM3NSBDIDguMjUgMTAuOTcyNjU2IDguMTM2NzE5IDEwLjg1OTM3NSA4IDEwLjg1OTM3NSBaIE0gOCAxMC44NTkzNzUgIi8+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoNTUuMjk0MTE4JSw0Mi4zNTI5NDElLDYyLjM1Mjk0MSUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA5LjI1IDEwLjg1OTM3NSBDIDkuMTEzMjgxIDEwLjg1OTM3NSA5IDEwLjk3MjY1NiA5IDExLjEwOTM3NSBMIDkgMTEuNjA5Mzc1IEMgOSAxMS43NDYwOTQgOS4xMTMyODEgMTEuODU5Mzc1IDkuMjUgMTEuODU5Mzc1IEMgOS4zODY3MTkgMTEuODU5Mzc1IDkuNSAxMS43NDYwOTQgOS41IDExLjYwOTM3NSBMIDkuNSAxMS4xMDkzNzUgQyA5LjUgMTAuOTcyNjU2IDkuMzg2NzE5IDEwLjg1OTM3NSA5LjI1IDEwLjg1OTM3NSBaIE0gOS4yNSAxMC44NTkzNzUgIi8+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoNTUuMjk0MTE4JSw0Mi4zNTI5NDElLDYyLjM1Mjk0MSUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSAxMC41IDEwLjg1OTM3NSBDIDEwLjM2MzI4MSAxMC44NTkzNzUgMTAuMjUgMTAuOTcyNjU2IDEwLjI1IDExLjEwOTM3NSBMIDEwLjI1IDExLjYwOTM3NSBDIDEwLjI1IDExLjc0NjA5NCAxMC4zNjMyODEgMTEuODU5Mzc1IDEwLjUgMTEuODU5Mzc1IEMgMTAuNjM2NzE5IDExLjg1OTM3NSAxMC43NSAxMS43NDYwOTQgMTAuNzUgMTEuNjA5Mzc1IEwgMTAuNzUgMTEuMTA5Mzc1IEMgMTAuNzUgMTAuOTcyNjU2IDEwLjYzNjcxOSAxMC44NTkzNzUgMTAuNSAxMC44NTkzNzUgWiBNIDEwLjUgMTAuODU5Mzc1ICIvPgo8cGF0aCBzdHlsZT0iIHN0cm9rZTpub25lO2ZpbGwtcnVsZTpub256ZXJvO2ZpbGw6cmdiKDU1LjI5NDExOCUsNDIuMzUyOTQxJSw2Mi4zNTI5NDElKTtmaWxsLW9wYWNpdHk6MTsiIGQ9Ik0gMTMuNzY5NTMxIDIuNTc4MTI1IEwgMTIuODYzMjgxIDIuNTE1NjI1IEMgMTEuMzc4OTA2IDIuNDE3OTY5IDkuOTgwNDY5IDEuODc1IDguODE2NDA2IDAuOTQ1MzEyIEwgOC40Njg3NSAwLjY2NDA2MiBDIDguMTkxNDA2IDAuNDQ1MzEyIDcuODA4NTk0IDAuNDQ1MzEyIDcuNTMxMjUgMC42NjQwNjIgTCA3LjE4MzU5NCAwLjk0NTMxMiBDIDYuMDE5NTMxIDEuODc1IDQuNjIxMDk0IDIuNDE3OTY5IDMuMTMyODEyIDIuNTE1NjI1IEwgMi4yMzA0NjkgMi41NzgxMjUgQyAxLjgyMDMxMiAyLjYwNTQ2OSAxLjUwMzkwNiAyLjk2MDkzOCAxLjUzMTI1IDMuMzcxMDk0IEwgMS43MDMxMjUgNi4yNjE3MTkgQyAxLjg5ODQzOCA4Ljk4MDQ2OSAzLjE0MDYyNSAxMS40NjQ4NDQgNS4yMDMxMjUgMTMuMjU3ODEyIEwgNy41MDc4MTIgMTUuMjYxNzE5IEMgNy42NDg0MzggMTUuMzgyODEyIDcuODI0MjE5IDE1LjQ0NTMxMiA4IDE1LjQ0NTMxMiBDIDguMTc1NzgxIDE1LjQ0NTMxMiA4LjM1MTU2MiAxNS4zODI4MTIgOC40OTIxODggMTUuMjYxNzE5IEwgMTAuNzk2ODc1IDEzLjI1NzgxMiBDIDEyLjg1OTM3NSAxMS40NjQ4NDQgMTQuMTAxNTYyIDguOTgwNDY5IDE0LjI5Njg3NSA2LjI1NzgxMiBMIDE0LjQ2ODc1IDMuMzcxMDk0IEMgMTQuNDkyMTg4IDIuOTYwOTM4IDE0LjE3OTY4OCAyLjYwNTQ2OSAxMy43Njk1MzEgMi41NzgxMjUgWiBNIDEzLjc5Njg3NSA2LjIyMjY1NiBDIDEzLjY2Nzk2OSA4LjA0Njg3NSAxMy4wMzkwNjIgOS43NTM5MDYgMTIgMTEuMjAzMTI1IEwgMTIgMTEuMTA5Mzc1IEMgMTIgMTAuOTcyNjU2IDExLjg4NjcxOSAxMC44NTkzNzUgMTEuNzUgMTAuODU5Mzc1IEMgMTEuNjEzMjgxIDEwLjg1OTM3NSAxMS41IDEwLjk3MjY1NiAxMS41IDExLjEwOTM3NSBMIDExLjUgMTEuNjA5Mzc1IEMgMTEuNSAxMS42NzE4NzUgMTEuNTIzNDM4IDExLjcyMjY1NiAxMS41NTg1OTQgMTEuNzY1NjI1IEMgMTEuMjMwNDY5IDEyLjE2NDA2MiAxMC44NjcxODggMTIuNTM1MTU2IDEwLjQ3MjY1NiAxMi44Nzg5MDYgTCA4LjE2NDA2MiAxNC44ODY3MTkgQyA4LjA3MDMxMiAxNC45Njg3NSA3LjkyOTY4OCAxNC45Njg3NSA3LjgzNTkzOCAxNC44ODY3MTkgTCA1LjUzMTI1IDEyLjg3ODkwNiBDIDUuMTMyODEyIDEyLjUzNTE1NiA0Ljc2OTUzMSAxMi4xNjQwNjIgNC40NDE0MDYgMTEuNzY5NTMxIEMgNC40NzY1NjIgMTEuNzIyNjU2IDQuNSAxMS42NzE4NzUgNC41IDExLjYwOTM3NSBMIDQuNSAxMS4xMDkzNzUgQyA0LjUgMTAuOTcyNjU2IDQuMzg2NzE5IDEwLjg1OTM3NSA0LjI1IDEwLjg1OTM3NSBDIDQuMTEzMjgxIDEwLjg1OTM3NSA0IDEwLjk3MjY1NiA0IDExLjEwOTM3NSBMIDQgMTEuMjAzMTI1IEMgMi45NjA5MzggOS43NTM5MDYgMi4zMzIwMzEgOC4wNDY4NzUgMi4yMDMxMjUgNi4yMjY1NjIgTCAyLjAzMTI1IDMuMzM5ODQ0IEMgMi4wMjM0MzggMy4yMDMxMjUgMi4xMjUgMy4wODU5MzggMi4yNjE3MTkgMy4wNzQyMTkgTCAzLjE2Nzk2OSAzLjAxNTYyNSBDIDQuNzU3ODEyIDIuOTEwMTU2IDYuMjUzOTA2IDIuMzI4MTI1IDcuNDk2MDk0IDEuMzM1OTM4IEwgNy44NDM3NSAxLjA1NDY4OCBDIDcuODkwNjI1IDEuMDE5NTMxIDcuOTQ1MzEyIDEgOCAxIEMgOC4wNTQ2ODggMSA4LjEwOTM3NSAxLjAxOTUzMSA4LjE1NjI1IDEuMDU0Njg4IEwgOC41MDc4MTIgMS4zMzU5MzggQyA5Ljc1IDIuMzI4MTI1IDExLjI0MjE4OCAyLjkxMDE1NiAxMi44MzIwMzEgMy4wMTU2MjUgTCAxMy43MzgyODEgMy4wNzgxMjUgQyAxMy44NzUgMy4wODU5MzggMTMuOTc2NTYyIDMuMjAzMTI1IDEzLjk2ODc1IDMuMzM5ODQ0IFogTSAxMy43OTY4NzUgNi4yMjI2NTYgIi8+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoNTUuMjk0MTE4JSw0Mi4zNTI5NDElLDYyLjM1Mjk0MSUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA4IDIuMjE0ODQ0IEwgOC42NDA2MjUgMi42NjQwNjIgQyA5LjMzNTkzOCAzLjE0ODQzOCAxMC4xMDE1NjIgMy41MTU2MjUgMTAuOTE0MDYyIDMuNzUzOTA2IEMgMTEuMDQyOTY5IDMuNzkyOTY5IDExLjE4MzU5NCAzLjcxNDg0NCAxMS4yMjI2NTYgMy41ODU5MzggQyAxMS4yNjE3MTkgMy40NTMxMjUgMTEuMTgzNTk0IDMuMzEyNSAxMS4wNTA3ODEgMy4yNzM0MzggQyAxMC4yOTI5NjkgMy4wNTA3ODEgOS41NzgxMjUgMi43MTA5MzggOC45Mjk2ODggMi4yNTM5MDYgTCA4LjI4NTE1NiAxLjgwNDY4OCBDIDguMTE3MTg4IDEuNjgzNTk0IDcuODgyODEyIDEuNjgzNTk0IDcuNzE0ODQ0IDEuODA0Njg4IEwgNy4wNzAzMTIgMi4yNTM5MDYgQyA1Ljk4ODI4MSAzLjAxMTcxOSA0LjcxNDg0NCAzLjQ2MDkzOCAzLjM5NDUzMSAzLjU1MDc4MSBMIDMuMjM0Mzc1IDMuNTU4NTk0IEMgMy4wOTM3NSAzLjU3MDMxMiAyLjk5MjE4OCAzLjY4NzUgMyAzLjgyODEyNSBDIDMuMDA3ODEyIDMuOTU3MDMxIDMuMTIxMDk0IDQuMDU4NTk0IDMuMjUgNC4wNTg1OTQgQyAzLjI1MzkwNiA0LjA1ODU5NCAzLjI2MTcxOSA0LjA1ODU5NCAzLjI2NTYyNSA0LjA1ODU5NCBMIDMuNDI5Njg4IDQuMDQ2ODc1IEMgNC44Mzk4NDQgMy45NTMxMjUgNi4xOTkyMTkgMy40NzY1NjIgNy4zNTkzNzUgMi42NjQwNjIgWiBNIDggMi4yMTQ4NDQgIi8+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoNTUuMjk0MTE4JSw0Mi4zNTI5NDElLDYyLjM1Mjk0MSUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSAxMi43NTM5MDYgMy41NTg1OTQgTCAxMi42MDU0NjkgMy41NTA3ODEgQyAxMi40MTQwNjIgMy41MzUxNTYgMTIuMjIyNjU2IDMuNTE1NjI1IDEyLjAzNTE1NiAzLjQ4ODI4MSBDIDExLjg5ODQzOCAzLjQ2ODc1IDExLjc2OTUzMSAzLjU2MjUgMTEuNzUgMy42OTkyMTkgQyAxMS43MzA0NjkgMy44MzU5MzggMTEuODI0MjE5IDMuOTY0ODQ0IDExLjk2MDkzOCAzLjk4NDM3NSBDIDEyLjE2NDA2MiA0LjAxMTcxOSAxMi4zNjcxODggNC4wMzUxNTYgMTIuNTcwMzEyIDQuMDQ2ODc1IEwgMTIuNzE4NzUgNC4wNTg1OTQgQyAxMi43MjI2NTYgNC4wNTg1OTQgMTIuNzMwNDY5IDQuMDU4NTk0IDEyLjczNDM3NSA0LjA1ODU5NCBDIDEyLjg2NzE4OCA0LjA1ODU5NCAxMi45NzY1NjIgMy45NTcwMzEgMTIuOTg0Mzc1IDMuODI0MjE5IEMgMTIuOTk2MDk0IDMuNjg3NSAxMi44OTA2MjUgMy41NzAzMTIgMTIuNzUzOTA2IDMuNTU4NTk0IFogTSAxMi43NTM5MDYgMy41NTg1OTQgIi8+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoNTUuMjk0MTE4JSw0Mi4zNTI5NDElLDYyLjM1Mjk0MSUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA1LjQ4ODI4MSA1LjY3MTg3NSBDIDUuNDUzMTI1IDUuNTcwMzEyIDUuMzU5Mzc1IDUuNSA1LjI1IDUuNSBDIDUuMTQwNjI1IDUuNSA1LjA0Njg3NSA1LjU3MDMxMiA1LjAxMTcxOSA1LjY3MTg3NSBMIDQuMDExNzE5IDguNjcxODc1IEMgMy45Njg3NSA4LjgwMDc4MSA0LjAzOTA2MiA4Ljk0NTMxMiA0LjE3MTg3NSA4Ljk4ODI4MSBDIDQuMzAwNzgxIDkuMDMxMjUgNC40NDUzMTIgOC45NjA5MzggNC40ODgyODEgOC44MjgxMjUgTCA0LjU5NzY1NiA4LjUgTCA1LjkwMjM0NCA4LjUgTCA2LjAxMTcxOSA4LjgyODEyNSBDIDYuMDQ2ODc1IDguOTMzNTk0IDYuMTQ0NTMxIDkgNi4yNSA5IEMgNi4yNzczNDQgOSA2LjMwNDY4OCA4Ljk5NjA5NCA2LjMyODEyNSA4Ljk4ODI4MSBDIDYuNDYwOTM4IDguOTQ1MzEyIDYuNTMxMjUgOC44MDA3ODEgNi40ODgyODEgOC42NzE4NzUgWiBNIDQuNzYxNzE5IDggTCA1LjI1IDYuNTM5MDYyIEwgNS43MzgyODEgOCBaIE0gNC43NjE3MTkgOCAiLz4KPHBhdGggc3R5bGU9IiBzdHJva2U6bm9uZTtmaWxsLXJ1bGU6bm9uemVybztmaWxsOnJnYig1NS4yOTQxMTglLDQyLjM1Mjk0MSUsNjIuMzUyOTQxJSk7ZmlsbC1vcGFjaXR5OjE7IiBkPSJNIDguNzUgOC41IEwgNy41IDguNSBMIDcuNSA3LjUgTCA4LjI1IDcuNSBDIDguMzg2NzE5IDcuNSA4LjUgNy4zODY3MTkgOC41IDcuMjUgQyA4LjUgNy4xMTMyODEgOC4zODY3MTkgNyA4LjI1IDcgTCA3LjUgNyBMIDcuNSA2IEwgOC43NSA2IEMgOC44ODY3MTkgNiA5IDUuODg2NzE5IDkgNS43NSBDIDkgNS42MTMyODEgOC44ODY3MTkgNS41IDguNzUgNS41IEwgNy4yNSA1LjUgQyA3LjExMzI4MSA1LjUgNyA1LjYxMzI4MSA3IDUuNzUgTCA3IDguNzUgQyA3IDguODg2NzE5IDcuMTEzMjgxIDkgNy4yNSA5IEwgOC43NSA5IEMgOC44ODY3MTkgOSA5IDguODg2NzE5IDkgOC43NSBDIDkgOC42MTMyODEgOC44ODY3MTkgOC41IDguNzUgOC41IFogTSA4Ljc1IDguNSAiLz4KPHBhdGggc3R5bGU9IiBzdHJva2U6bm9uZTtmaWxsLXJ1bGU6bm9uemVybztmaWxsOnJnYig1NS4yOTQxMTglLDQyLjM1Mjk0MSUsNjIuMzUyOTQxJSk7ZmlsbC1vcGFjaXR5OjE7IiBkPSJNIDEwLjI1IDYgTCAxMSA2IEMgMTEuMTM2NzE5IDYgMTEuMjUgNi4xMTMyODEgMTEuMjUgNi4yNSBDIDExLjI1IDYuMzg2NzE5IDExLjM2MzI4MSA2LjUgMTEuNSA2LjUgQyAxMS42MzY3MTkgNi41IDExLjc1IDYuMzg2NzE5IDExLjc1IDYuMjUgQyAxMS43NSA1LjgzNTkzOCAxMS40MTQwNjIgNS41IDExIDUuNSBMIDEwLjI1IDUuNSBDIDkuODM1OTM4IDUuNSA5LjUgNS44MzU5MzggOS41IDYuMjUgTCA5LjUgNi43NSBDIDkuNSA3LjE2NDA2MiA5LjgzNTkzOCA3LjUgMTAuMjUgNy41IEwgMTEgNy41IEMgMTEuMTM2NzE5IDcuNSAxMS4yNSA3LjYxMzI4MSAxMS4yNSA3Ljc1IEwgMTEuMjUgOC4yNSBDIDExLjI1IDguMzg2NzE5IDExLjEzNjcxOSA4LjUgMTEgOC41IEwgMTAuMjUgOC41IEMgMTAuMTEzMjgxIDguNSAxMCA4LjM4NjcxOSAxMCA4LjI1IEMgMTAgOC4xMTMyODEgOS44ODY3MTkgOCA5Ljc1IDggQyA5LjYxMzI4MSA4IDkuNSA4LjExMzI4MSA5LjUgOC4yNSBDIDkuNSA4LjY2NDA2MiA5LjgzNTkzOCA5IDEwLjI1IDkgTCAxMSA5IEMgMTEuNDE0MDYyIDkgMTEuNzUgOC42NjQwNjIgMTEuNzUgOC4yNSBMIDExLjc1IDcuNzUgQyAxMS43NSA3LjMzNTkzOCAxMS40MTQwNjIgNyAxMSA3IEwgMTAuMjUgNyBDIDEwLjExMzI4MSA3IDEwIDYuODg2NzE5IDEwIDYuNzUgTCAxMCA2LjI1IEMgMTAgNi4xMTMyODEgMTAuMTEzMjgxIDYgMTAuMjUgNiBaIE0gMTAuMjUgNiAiLz4KPHBhdGggc3R5bGU9IiBzdHJva2U6bm9uZTtmaWxsLXJ1bGU6bm9uemVybztmaWxsOnJnYig5OC4wMzkyMTYlLDkzLjcyNTQ5JSw4Ny4wNTg4MjQlKTtmaWxsLW9wYWNpdHk6MTsiIGQ9Ik0gOC4wOTM3NSAzLjEwOTM3NSBMIDguNDA2MjUgMy42NzU3ODEgTCA4Ljk3MjY1NiAzLjk4NDM3NSBMIDguNDA2MjUgNC4yOTI5NjkgTCA4LjA5Mzc1IDQuODU5Mzc1IEwgNy43ODUxNTYgNC4yOTI5NjkgTCA3LjIxODc1IDMuOTg0Mzc1IEwgNy43ODUxNTYgMy42NzU3ODEgWiBNIDguMDkzNzUgMy4xMDkzNzUgIi8+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoOTguMDM5MjE2JSw5My43MjU0OSUsODcuMDU4ODI0JSk7ZmlsbC1vcGFjaXR5OjE7IiBkPSJNIDMuNTc0MjE5IDUuODU5Mzc1IEwgMy43ODkwNjIgNi4yNSBMIDQuMTc5Njg4IDYuNDY0ODQ0IEwgMy43ODkwNjIgNi42Nzk2ODggTCAzLjU3NDIxOSA3LjA3MDMxMiBMIDMuMzU5Mzc1IDYuNjc5Njg4IEwgMi45Njg3NSA2LjQ2NDg0NCBMIDMuMzU5Mzc1IDYuMjUgWiBNIDMuNTc0MjE5IDUuODU5Mzc1ICIvPgo8cGF0aCBzdHlsZT0iIHN0cm9rZTpub25lO2ZpbGwtcnVsZTpub256ZXJvO2ZpbGw6cmdiKDk4LjAzOTIxNiUsOTMuNzI1NDklLDg3LjA1ODgyNCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSAxMC44ODI4MTIgOS4zNTkzNzUgTCAxMS4wMjczNDQgOS42MjUgTCAxMS4yOTI5NjkgOS43NzM0MzggTCAxMS4wMjczNDQgOS45MTc5NjkgTCAxMC44ODI4MTIgMTAuMTgzNTk0IEwgMTAuNzM0Mzc1IDkuOTE3OTY5IEwgMTAuNDY4NzUgOS43NzM0MzggTCAxMC43MzQzNzUgOS42MjUgWiBNIDEwLjg4MjgxMiA5LjM1OTM3NSAiLz4KPC9nPgo8L3N2Zz4K")
@SimpleObject(external = true)


public class MareshaAES extends AndroidNonvisibleComponent implements Component {
public static final int VERSION = 1;
private ComponentContainer container;
private Context context;
private static final String LOG_TAG = "";

 public MareshaAES(ComponentContainer container) {
    super(container.$form());
    this.container = container;
    context = (Context) container.$context();
    Log.d(LOG_TAG, "Maresha" );
}
@SimpleFunction(description = "Encrypt arbitrary string via AES")
public String AESEncrypt(String text,String salt,String secret){
    return AES.encrypt(text,salt, secret);

   }
@SimpleFunction(description = "Decrypt arbitrary string via AES")
public String AESDecrypt(String text,String salt,String secret){
    return AES.decrypt(text,salt, secret);
    }
@SimpleFunction(description = "Generate SALT")
public String Salt(String secret){
    return AES.encrypt("Default text hust in case ","Non default salt forexample",secret);
    }


  
public static final class AES {
    

    // Encrypt method




    public static String encrypt(String strToEncrypt,final String SALT,final String SECRET_KEY)
    {
        try {
  
            // Create default byte array
            byte[] iv = { 0, 0, 0, 0, 0, 0, 0, 0,
                          0, 0, 0, 0, 0, 0, 0, 0 };
            IvParameterSpec ivspec
                = new IvParameterSpec(iv);
  
            // Create SecretKeyFactory object
            SecretKeyFactory factory
                = SecretKeyFactory.getInstance(
                    "PBKDF2WithHmacSHA256");
            
            // Create KeySpec object and assign with
            // constructor
            KeySpec spec = new PBEKeySpec(
                SECRET_KEY.toCharArray(), SALT.getBytes(),
                65536, 256);
            SecretKey tmp = factory.generateSecret(spec);
            SecretKeySpec secretKey = new SecretKeySpec(
                tmp.getEncoded(), "AES");
  
            Cipher cipher = Cipher.getInstance(
                "AES/CBC/PKCS5Padding");
            cipher.init(Cipher.ENCRYPT_MODE, secretKey,
                        ivspec);
            // Return encrypted string
            return Base64.getEncoder().encodeToString(
                cipher.doFinal(strToEncrypt.getBytes(
                    StandardCharsets.UTF_8)));
        }
        catch (Exception e) {
            System.out.println("Error while encrypting: "
                               + e.toString());
        }
        return "Error";
    }
  
    // This method use to decrypt to string
    public static String decrypt(String strToDecrypt,final String SALT,final String SECRET_KEY)
    {
        try {
  
            // Default byte array
            byte[] iv = { 0, 0, 0, 0, 0, 0, 0, 0,
                          0, 0, 0, 0, 0, 0, 0, 0 };
            // Create IvParameterSpec object and assign with
            // constructor
            IvParameterSpec ivspec
                = new IvParameterSpec(iv);
  
            // Create SecretKeyFactory Object
            SecretKeyFactory factory
                = SecretKeyFactory.getInstance(
                    "PBKDF2WithHmacSHA256");
  
            // Create KeySpec object and assign with
            // constructor
            KeySpec spec = new PBEKeySpec(
                SECRET_KEY.toCharArray(), SALT.getBytes(),
                65536, 256);
            SecretKey tmp = factory.generateSecret(spec);
            SecretKeySpec secretKey = new SecretKeySpec(
                tmp.getEncoded(), "AES");
  
            Cipher cipher = Cipher.getInstance(
                "AES/CBC/PKCS5PADDING");
            cipher.init(Cipher.DECRYPT_MODE, secretKey,
                        ivspec);
            // Return decrypted string
            return new String(cipher.doFinal(
                Base64.getDecoder().decode(strToDecrypt)));
        }
        catch (Exception e) {
            System.out.println("Error while decrypting: "
                               + e.toString());
        }
        return "Error";
    }
}
}


// Thanks
